{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CryptoSim </title>
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="{% static './images/favicon.png' %}">
    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="{% static './vendor/nice-select/css/nice-select.css' %}">
    <link rel="stylesheet" href="{% static './vendor/waves/waves.min.css' %}">
    <link rel="stylesheet" href="{% static './vendor/magnific-popup/magnific-popup.css' %}">
    <link rel="stylesheet" href="{% static './css/style.css' %}">
</head>

<body>

    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>

    <div id="main-wrapper">

        <div class="header dashboard">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xl-12">
                        <nav class="navbar navbar-expand-lg navbar-light px-0 justify-content-between">
                            <a class="navbar-brand" href="{% url 'home:dashboard' %}"><img src="./images/logo.png"
                                    alt=""></a>

                            <div class="header-right d-flex my-2 align-items-center">
                                <div class="language">
                                    <div class="dropdown">
                                        <div class="icon" data-toggle="dropdown">
                                            <i class="flag-icon flag-icon-us"></i>
                                            <span>English</span>
                                        </div>
                                        <div class="dropdown-menu dropdown-menu-right">
                                            <a href="#" class="dropdown-item">
                                                <i class="flag-icon flag-icon-bd"></i> Bengali
                                            </a>
                                            <a href="#" class="dropdown-item">
                                                <i class="flag-icon flag-icon-fr"></i> French
                                            </a>
                                            <a href="#" class="dropdown-item">
                                                <i class="flag-icon flag-icon-cn"></i> China
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="dashboard_log">
                                    <div class="profile_log dropdown">
                                        <div class="user" data-toggle="dropdown">
                                            <span class="thumb"><i class="mdi mdi-account"></i></span>
                                            <span class="arrow"><i class="mdi mdi-angle-down"></i></span>
                                        </div>

                                        <div class="dropdown-menu dropdown-menu-right">
                                            <div class="user-email">
                                                <div class="user">
                                                    <i class="thumb"><i class="mdi mdi-account"></i></i>
                                                    <div class="user-info">
                                                        <h6>{{ user.first_name }}</h6>
                                                        <span>{{user.email}}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="user-balance">
                                                <div class="available">
                                                    <p>Available</p>
                                                    <span>{{balance}} USD</span>
                                                </div>
                                                <div class="total">
                                                    <p>Total</p>
                                                    <span>{{total|floatformat:2}} USD</span>
                                                </div>
                                            </div>
                                            <a href="{% url 'home:account' %}" class="dropdown-item">
                                                <i class="mdi mdi-account"></i> Account
                                            </a>
                                            <a href="{% url 'home:signals' %}" class="dropdown-item">
                                                <i class="mdi mdi-history"></i> History
                                            </a>
                                            <a href="{% url 'home:setting'%}" class="dropdown-item">
                                                <i class="mdi mdi-settings"></i> Setting
                                            </a>
                                            <a href="lock.html" class="dropdown-item">
                                                <i class="mdi mdi-lock"></i> Lock
                                            </a>
                                            <a href="signin.html" class="dropdown-item logout">
                                                <i class="mdi mdi-logout"></i> Logout
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="menu">
                <ul>
                    <li>
                        <a href="{% url 'home:dashboard' %}" data-toggle="tooltip" data-placement="right" title="Trade">
                            <span><i class="mdi mdi-view-dashboard"></i></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'home:account_exchange' %}" data-toggle="tooltip" data-placement="right"
                            title="Exchange">
                            <span><i class="mdi mdi-tumblr-reblog"></i></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'home:account' %}" data-toggle="tooltip" data-placement="right"
                            title="Accounts">
                            <span><i class="mdi mdi-face-profile"></i></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'home:signals' %}" data-toggle="tooltip" data-placement="right" title="Data">
                            <span><i class="mdi mdi-database"></i></span>
                        </a>
                    </li>
                    <li>
                        <a href="{% url 'home:setting'%}" data-toggle="tooltip" data-placement="right" title="Setting">
                            <span><i class="mdi mdi-settings"></i></span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="page-title dashboard">
            <div class="container">
                <div class="row">
                    <div class="col-6">
                        <div class="page-title-content">
                            <p>Welcome Back,
                                <span> {{user.first_name}}</span>
                            </p>
                        </div>
                    </div>
                    <div class="col-6">
                        <ul class="text-right breadcrumbs list-unstyle">
                            <li><a href="{% url 'home:setting'%}">Settings </a></li>
                            <li class="active"><a href="#">Security</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-body">
            <div class="container">
                <div class="row">
                    <div class="col-xl-6 col-lg-6 col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Buy</h4>
                            </div>
                            <div class="card-body">
                                <div class="buy-sell-widget">
                                    <form method="post" name="myform" class="currency_validate" id="buying">
                                        {% csrf_token %}
                                        <div class="form-group">
                                            <label class="mr-sm-2">Cryptocurrency</label>
                                            <div class="input-group mb-3">
                                                <select name='currency' class="form-control mw-300">
                                                    <!-- mw-150 -->
                                                    <option data-display="Bitcoin at {{price}} USD" value="bitcoin">Bitcoin
                                                    </option>
                                                    <!-- <option value="litecoin">Litecoin</option> -->
                                                </select>
                                                <!-- <input type="text" name="btc_amount" class="form-control text-right"
                                                    value="" placeholder="{{ price }} USD"> -->
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="mr-sm-2">With</label>
                                            <div class="input-group mb-3">
                                                <select name='currency' class="form-control">
                                                    <option data-display="Tether" value="Tether">Tether
                                                    </option>
                                                    <!-- <option value="litecoin">Litecoin</option> -->
                                                </select>
                                                <!-- <input type="text" name="usd_amount" class="form-control"
                                                    value="125.00 USD"> -->
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="mr-sm-2">Enter amount</label>
                                            <div class="input-group">
                                                <input type="text" name="btc-amount" id="amount" class="form-control"
                                                    placeholder="{{amount}} BTC">
                                                <!-- <input type="text" name="usd_amount" class="form-control"
                                                    placeholder="125.00 USD"> -->
                                            </div>
                                            <div class="d-flex justify-content-between mt-3">
                                                <p class="mb-0">Balance:</p>
                                                <h6 class="mb-0" id="remaining">{{balance|floatformat:2}} USD</h6>
                                            </div>
                                        </div>
                                        <button type="submit" name="submit" class="btn btn-success btn-block">Buy
                                            Virtually</button>

                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Sell</h4>
                            </div>
                            <div class="card-body">
                                <div class="buy-sell-widget">
                                    <form method="post" name="myform" class="currency_validate" id="selling">
                                        {% csrf_token %}
                                        <div class="form-group">
                                            <label class="mr-sm-2">Cryptocurrency</label>
                                            <div class="input-group mb-3">
                                                <select name='currency' class="form-control mw-300">
                                                    <option data-display="Bitcoin at {{price}} USD" value="bitcoin">Bitcoin
                                                    </option>
                                                    <!-- <option value="litecoin">Litecoin</option> -->
                                                </select>
                                                <!-- <input type="text" name="usd_amount" id="amount-id" class="form-control text-right"
                                                    value="" placeholder="{{amount}} BTC"> -->
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="mr-sm-2">Receive</label>
                                            <div class="input-group mb-3">
                                                <select name='currency' class="form-control">
                                                    <option data-display="Tether" value="Tether">Tether
                                                    </option>
                                                    <!-- <option value="litecoin">Litecoin</option> -->
                                                </select>
                                                <!-- <input type="text" name="usd_amount" class="form-control"
                                                    value="125.00 USD"> -->
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="mr-sm-2">Enter amount</label>
                                            <div class="input-group">
                                                <input required type="text" name="btc-amount-sell" id="amount_sell" class="form-control"
                                                    placeholder="{{amount}} BTC">
                                                <!-- <input type="text" name="usd_amount" class="form-control"
                                                    placeholder="125.00 USD"> -->
                                            </div>
                                            <div class="d-flex justify-content-between mt-3">
                                                <p class="mb-0">Balance:</p>
                                                <h6 class="mb-0" id="remaining-btc">{{btc|floatformat:2}} BTC</h6>
                                            </div>
                                        </div>
                                        <button type="submit" name="submit" class="btn btn-danger btn-block">Sell
                                            Virtually</button>

                                    </form>
                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-xl-9 col-lg-9 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="buyer-seller">
                                    <div class="d-flex justify-content-between mb-3">
                                        <div class="buyer-info">
                                            <div class="media">
                                                <img class="mr-3 rounded" src="./images/avatar/2.jpg" alt="">
                                                <div class="media-body">
                                                    <h4>Buyer</h4>
                                                    <h5 class="text-body">Michael John</h5>
                                                    <a href="#" class="text-body">{{ user.email}}</a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="seller-info text-right">
                                            <div class="media">
                                                <div class="media-body">
                                                    <h4>Seller</h4>
                                                    <h5 class="text-body">John Doe</h5>
                                                    <a href="#" class="text-body">{{ user.email}}</a>
                                                </div>
                                                <img class="ml-3 rounded" src="./images/avatar/5.jpg" alt="">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-striped">
                                            <tbody>
                                                <tr>
                                                    <td><span class="text-primary">You are selling</span></td>
                                                    <td><span class="text-primary">0.00254 BTC</span></td>
                                                </tr>
                                                <tr>
                                                    <td>Payment Method</td>
                                                    <td>Bank of America Bank ***********5245</td>
                                                </tr>
                                                <tr>
                                                    <td>Exchange Rate</td>
                                                    <td>0.00212455 BTC</td>
                                                </tr>
                                                <tr>
                                                    <td>Fee</td>
                                                    <td>$28.00 USD</td>
                                                </tr>
                                                <tr>
                                                    <td>Total</td>
                                                    <td>$854.00 USD</td>
                                                </tr>
                                                <tr>
                                                    <td>Vat</td>
                                                    <td>
                                                        <div class="text-danger">$25.00 USD</div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td> Sub Total</td>
                                                    <td> $1232.00 USD</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> -->

                    <!-- Bank of America Bank  -->

                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">All Activities</h4>
                            </div>
                            <div class="card-body">
                                <div class="transaction-table">
                                    <div class="table-responsive">
                                        <table class="table table-striped mb-0 table-responsive-sm">
                                            <tbody>
                                                <tr>
                                                    <td><span class="sold-thumb"><i
                                                                class="mdi mdi-arrow-down"></i></span>
                                                    </td>

                                                    <td>
                                                        <span class="badge badge-danger p-2">Sold</span>
                                                    </td>
                                                    <td>
                                                        <i class="cc BTC"></i> BTC
                                                    </td>
                                                    <td>
                                                        Using - Bank *******5264
                                                    </td>
                                                    <td class="text-danger">-0.000242 BTC</td>
                                                    <td>-0.125 USD</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="buy-thumb"><i class="mdi mdi-arrow-up"></i></span>
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-success p-2">Buy</span>
                                                    </td>
                                                    <td>
                                                        <i class="cc LTC"></i> LTC
                                                    </td>
                                                    <td>
                                                        Using - Card *******8475
                                                    </td>
                                                    <td class="text-success">-0.000242 BTC</td>
                                                    <td>-0.125 USD</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="sold-thumb"><i
                                                                class="mdi mdi-arrow-down"></i></span>
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-danger p-2">Sold</span>
                                                    </td>
                                                    <td>
                                                        <i class="cc XRP"></i> XRP
                                                    </td>
                                                    <td>
                                                        Using - Card *******8475
                                                    </td>
                                                    <td class="text-danger">-0.000242 BTC</td>
                                                    <td>-0.125 USD</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="buy-thumb"><i class="mdi mdi-arrow-up"></i></span>
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-success p-2">Buy</span>
                                                    </td>
                                                    <td>
                                                        <i class="cc DASH"></i> DASH
                                                    </td>
                                                    <td>
                                                        Using - Card *******2321
                                                    </td>
                                                    <td class="text-success">-0.000242 BTC</td>
                                                    <td>-0.125 USD</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="sold-thumb"><i
                                                                class="mdi mdi-arrow-down"></i></span>
                                                    </td>
                                                    <td>
                                                        <span class="badge badge-danger p-2">Sold</span>
                                                    </td>
                                                    <td>
                                                        <i class="cc BTC"></i> BTC
                                                    </td>
                                                    <td>
                                                        Using - Card *******2321
                                                    </td>
                                                    <td class="text-danger">-0.000242 BTC</td>
                                                    <td>-0.125 USD</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- <div class="col-xl-6 col-lg-6 col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">FAQ</h4>
                            </div>
                            <div class="card-body">
                                <div id="accordion-faq" class="accordion">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0 collapsed c-pointer" data-toggle="collapse"
                                                data-target="#collapseOne1" aria-expanded="false"
                                                aria-controls="collapseOne1"><i class="fa" aria-hidden="true"></i>What
                                                Shipping Methods are Available?</h5>
                                        </div>
                                        <div id="collapseOne1" class="collapse show" data-parent="#accordion-faq">
                                            <div class="card-body">Anim pariatur cliche reprehenderit, enim eiusmod high
                                                life accusamus terry richardson ad squid. 3 wolf moon officia aute, non
                                                cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum
                                                eiusmod.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0 collapsed c-pointer" data-toggle="collapse"
                                                data-target="#collapseTwo2" aria-expanded="false"
                                                aria-controls="collapseTwo2"><i class="fa" aria-hidden="true"></i>How
                                                Long Will it Take To Get My Package?</h5>
                                        </div>
                                        <div id="collapseTwo2" class="collapse" data-parent="#accordion-faq">
                                            <div class="card-body">Anim pariatur cliche reprehenderit, enim eiusmod high
                                                life accusamus terry richardson ad squid. 3 wolf moon officia aute, non
                                                cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum
                                                eiusmod.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0 collapsed c-pointer" data-toggle="collapse"
                                                data-target="#collapseThree3" aria-expanded="false"
                                                aria-controls="collapseThree3"><i class="fa" aria-hidden="true"></i>How
                                                Do I Track My Order?</h5>
                                        </div>
                                        <div id="collapseThree3" class="collapse" data-parent="#accordion-faq">
                                            <div class="card-body">Anim pariatur cliche reprehenderit, enim eiusmod high
                                                life accusamus terry richardson ad squid. 3 wolf moon officia aute, non
                                                cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum
                                                eiusmod.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0 collapsed c-pointer" data-toggle="collapse"
                                                data-target="#collapseThree4" aria-expanded="false"
                                                aria-controls="collapseThree4"><i class="fa" aria-hidden="true"></i>Do I
                                                Need A Account To Place Order?</h5>
                                        </div>
                                        <div id="collapseThree4" class="collapse" data-parent="#accordion-faq">
                                            <div class="card-body">Anim pariatur cliche reprehenderit, enim eiusmod high
                                                life accusamus terry richardson ad squid. 3 wolf moon officia aute, non
                                                cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum
                                                eiusmod.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="mb-0 collapsed c-pointer" data-toggle="collapse"
                                                data-target="#collapseThree5" aria-expanded="false"
                                                aria-controls="collapseThree5"><i class="fa" aria-hidden="true"></i>How
                                                do I Place an Order?</h5>
                                        </div>
                                        <div id="collapseThree5" class="collapse" data-parent="#accordion-faq">
                                            <div class="card-body">Anim pariatur cliche reprehenderit, enim eiusmod high
                                                life accusamus terry richardson ad squid. 3 wolf moon officia aute, non
                                                cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum
                                                eiusmod.
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-6 col-lg-6 col-md-12">
                        <div class="intro-video-play">
                            <div class="play-btn">
                                <a class="popup-youtube" href="https://www.youtube.com/watch?v=IjzUwnqWc5Q">
                                    <span><i class="fa fa-play"></i></span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->


                    <div class="footer dashboard">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-sm-8 col-12">
                                    <div class="copyright">
                                        <p>© Copyright 2020 <a href="#">CryptoSim </a>
                                            I All Rights Reserved</p>
                                    </div>
                                </div>
                                <div class="col-sm-4 col-12">
                                    <div class="footer-social">
                                        <ul>
                                            <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                            <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                            <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                                            <li><a href="#"><i class="fa fa-youtube"></i></a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <script src="{% static './js/global.js' %}"></script>

                <script src="{% static './vendor/waves/waves.min.js' %}"></script>
                <script src="{% static './vendor/magnific-popup/magnific-popup.js' %}"></script>
                <script src="{% static './vendor/magnific-popup/magnific-popup-init.js' %}"></script>



                <script src="{% static './vendor/validator/jquery.validate.js' %}"></script>
                <script src="{% static './vendor/validator/validator-init.js' %}"></script>
                <script src="{% static './vendor/perfect-scrollbar/perfect-scrollbar.min.js' %}"></script>
                <script src="{% static './js/scripts.js' %}"></script>

                <script type="text/javascript">

                    const form = document.getElementById('buying');
                    form.addEventListener("submit", submithandler);


                    function submithandler(e) {
                        e.preventDefault();

                        $.ajax({
                            type: 'POST',
                            url: "{% url 'home:account_exchange' %}",
                            data: {
                                amount: $('#amount').val(),
                                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                            },
                            success: function (resp) {
                                switch (resp.alarm) {
                                    case "not_enough":
                                        alert("not enought money in your wallet")
                                        break;
                                    case "successful":
                                        $("#remaining").html(resp.new_balance)
                                        $("#remaining-btc").html(resp.new_btc_balance)
                                        $("#amount").attr("placeholder", "{{amount}} BTC").val("").focus().blur();
                                        alert("you have successfully bought " + resp.amount + " BTC")
                                        break;
                                    case "empty":
                                        alert("You have to enter a number")
                                        break;
                                    default:
                                    // code block
                                }
                            }
                        });
                    }


                    const form2 = document.getElementById('selling');
                    form2.addEventListener("submit", submithandler2);


                    function submithandler2(e) {
                        e.preventDefault();

                        $.ajax({
                            type: 'POST',
                            url: "{% url 'home:account_exchange' %}",
                            data: {
                                amount_sell: $('#amount_sell').val(),
                                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
                            },
                            success: function (resp) {
                                switch (resp.alarm) {
                                    case "not_enough":
                                        alert("not enought Bitcoin in your wallet")
                                        break;
                                    case "successful":
                                        alert("you have successfully sold " + resp.amount + " BTC")
                                        $("#remaining-btc").html(resp.new_btc_balance)
                                        $("#remaining").html(resp.new_balance)
                                        $("#amount_sell").attr("placeholder", "{{amount}} BTC").val("").focus().blur();
                                        break;
                                    case "empty":
                                        alert("You have to enter a number")
                                        break;
                                    default:
                                    // code block
                                }
                                $("#selling").submit(function () {
                                    var $input = $(this).find("input[name=btc-amount-sell]");
                                    var $output = $(this).find("#remaining")
                                    if ($input.val() != null) {
                                        $input.val("");
                                    }
                                });
                            }
                        });

                        // const form = document.getElementById('current');
                        // const btc = document.getElementById('amount');
                        // const usdtotal = form.value * btc.value
                        // document.getElementById("current").value = usdtotal;
                    }
                </script>
</body>

</html>